import{_ as x,R as B,a as F,u as b,b as L,c as g,d as l,e as t,F as v,r as A,h as u,f as h,w as m,m as _,g as C,j as k,o as a,n as S,t as s,l as D,p as T}from"./index-DdJFh_N2.js";import{B as I}from"./BarcodeLabel-OkJeiJlc.js";const p="http://127.0.0.1:8000/api",N={name:"BookingsView",components:{RouterLink:B,BarcodeLabel:I},setup(){const o="https://www.frontair.nl"+C().path;F({title:"Bookings - FrontAir",link:[{rel:"canonical",href:o}],meta:[{name:"description",content:"The bookings page of FrontAir, a flight booking web application. Welcome to FrontAir, your one-stop destination for booking flights at the best prices. Find deals on international and domestic flights, compare airlines, and plan your perfect trip."},{name:"keywords",content:"bookings, booked flights, flights, flight booking, cheap flights, airline tickets, travel, FrontAir, flight deals, international flights, domestic flights"},{name:"author",content:"FrontAir"},{property:"og:title",content:"Bookings - FrontAir"},{property:"og:description",content:"The bookings page of FrontAir, a flight booking web application. Welcome to FrontAir, your one-stop destination for booking flights at the best prices. Find deals on international and domestic flights, compare airlines, and plan your perfect trip."},{property:"og:type",content:"website"},{property:"og:url",content:"https://www.frontair.nl"},{property:"og:image",content:"https://www.frontair.nl/images/frontair_logo.webp"}]})},data(){return{bookings:[],userStore:b()}},computed:{theme(){return L().siteTheme}},mounted(){this.retrieveBookings()},methods:{retrieveBookings(){const i=b();if(i.isLoggedIn)return console.log(i.user.id),g.get(p+"/users/"+i.user.id+"/bookings?sort_by=id&sort_order=desc").then(o=>{this.bookings=o.data.bookings,console.log(this.bookings)}).catch(o=>{console.error(o)}),console.log("User is logged in, retrieving bookings");console.log("User is not logged in")},cancelBooking(i){const o=b();if(confirm("Are you sure you want to cancel this booking?"))g.delete(p+"/bookings/"+i).then(r=>{console.log(r.data),this.retrieveBookings();const y=Number(o.user.wallet)+Number(r.data.flight.price),c={wallet:parseFloat(y).toFixed(2)};g.put(p+"/users/"+o.user.id,c).then(n=>{console.log(n.data),o.updateUser(n.data)}).catch(n=>{console.error(n)});const d={available_seats:r.data.flight.available_seats+1};g.put(p+"/flights/"+r.data.flight.id,d).then(n=>{console.log(n.data)}).catch(n=>{console.error(n)})}).catch(r=>{console.error(r)});else return},confirmBooking(i){if(confirm("Are you sure you want to confirm this booking?")){const o={booking_status:"booked"};g.put(p+"/bookings/"+i,o).then(r=>{console.log(r.data),this.retrieveBookings()}).catch(r=>{console.error(r)})}else return},formatDate(i){return new Date(i).toLocaleDateString("nl-NL",{year:"numeric",month:"numeric",day:"numeric",hour:"numeric",minute:"numeric",timeZone:"GMT"})}}},R=t("section",{class:"py-20"},[t("h1",null,[t("i",{class:"bi bi-ticket"}),u(" My Bookings")]),t("p",null,"Here you can see all your bookings."),t("p",null,' If the status of a booking is "booked", the flight can not be cancelled. ')],-1),U={key:0,class:"mb-20"},V={class:"grid grid-cols-1 gap-4 p-0 sm:p-4 md:grid-cols-2 xl:grid-cols-3"},j=["src","alt"],M={class:"card-header relative"},W={class:"absolute left-0 right-0 top-0 mt-4"},H=["src","alt"],P={class:"card-body mt-20"},z={class:"grid grid-cols-2 gap-2 sm:grid-cols-4 [&>*]:text-center"},E=t("p",{class:"text-lg font-bold"}," Status ",-1),G=t("p",{class:"text-lg font-bold"}," Class ",-1),Z=t("p",{class:"text-lg font-bold"}," Type ",-1),q=t("p",{class:"text-lg font-bold"}," Airline ",-1),J=t("div",{class:"divider my-2"},null,-1),K={class:"mb-4 grid grid-cols-1 gap-2 sm:grid-cols-2"},O={class:"flex flex-col"},Q=t("p",{class:"text-lg font-bold"}," From ",-1),X={class:"flex flex-col text-left sm:text-right"},Y=t("p",{class:"text-lg font-bold"}," To ",-1),$=t("p",{class:"text-center text-2xl font-bold"}," Ticket ",-1),tt=["onClick"],et=["onClick"],ot={class:"card-actions mt-auto items-end justify-end"},st={class:"text-center text-2xl font-bold sm:text-left"},it={key:1},rt={key:0},nt={key:1},lt=t("p",null," Please log in to view your bookings or register to start booking. ",-1);function at(i,o,r,y,c,d){const n=k("BarcodeLabel"),f=k("RouterLink");return a(),l(v,null,[R,c.bookings.length>0&&c.userStore.isLoggedIn==!0?(a(),l("section",U,[t("div",V,[(a(!0),l(v,null,A(c.bookings,e=>(a(),l("div",{key:e.id,class:S(["card bordered shadow-lg",d.theme=="frontair"?"":"shadow-white/30"])},[t("figure",null,[t("img",{class:"h-60 w-full object-cover object-center",src:"../src/assets/images/airlines/"+e.flight.airline.name.toLowerCase().replace(/\s/g,"_")+"/"+e.flight.image+".webp",alt:e.flight.airline.name!=null?e.flight.airline.name:"Image of Airline"},null,8,j)]),t("div",M,[t("div",W,[t("img",{class:"h-12 w-full",src:"../src/assets/images/airlines/"+e.flight.airline.name.toLowerCase().replace(/\s/g,"_")+".svg",alt:e.flight.airline.name!=null?e.flight.airline.name:"Image of Airline"},null,8,H)])]),t("div",P,[t("div",z,[t("div",null,[E,t("p",null,s(e.booking_status),1)]),t("div",null,[G,t("p",null,s(e.class),1)]),t("div",null,[Z,t("p",null,s(e.type),1)]),t("div",null,[q,t("p",null,s(e.flight.airline.name),1)])]),J,t("div",K,[t("div",O,[Q,t("p",null,s(e.flight.departure_airport.name),1),t("p",null,s(e.flight.departure_airport.city)+", "+s(e.flight.departure_airport.country),1),t("p",null,s(d.formatDate(e.flight.departure_time)),1)]),t("div",X,[Y,t("p",null,s(e.flight.arrival_airport.name),1),t("p",null,s(e.flight.arrival_airport.city)+", "+s(e.flight.arrival_airport.country),1),t("p",null,s(d.formatDate(e.flight.arrival_time)),1)])]),$,D(h(n,{value:e.user_id+""+e.flight.departure_airport.id+e.flight.arrival_airport.id+e.flight.flight_number+e.id},null,8,["value"]),[[T,e.booking_status=="booked"]]),e.booking_status=="pending"?(a(),l("button",{key:0,class:"btn btn-success absolute left-4 top-4",onClick:w=>d.confirmBooking(e.id)}," Confirm ",8,tt)):_("",!0),e.booking_status=="pending"?(a(),l("button",{key:1,class:"btn btn-error absolute right-4 top-4",onClick:w=>d.cancelBooking(e.id)}," Cancel ",8,et)):_("",!0),t("div",ot,[t("p",st," Price: â‚¬"+s(e.price),1),h(f,{class:"btn btn-info w-full sm:w-1/2 md:w-auto",to:{name:"bookings.show",params:{id:e.id}}},{default:m(()=>[u(" More details ")]),_:2},1032,["to"])])])],2))),128))])])):(a(),l("section",it,[c.bookings.length==0&&c.userStore.isLoggedIn==!0?(a(),l("p",rt,[u(" It's empty in here.. try booking a "),h(f,{to:{name:"flights"},class:"text-primary underline"},{default:m(()=>[u(" Flight ")]),_:1}),u(" ! ")])):_("",!0),c.userStore.isLoggedIn==!1?(a(),l("div",nt,[lt,h(f,{to:{name:"login"},class:"text-primary underline"},{default:m(()=>[u(" Login ")]),_:1}),h(f,{to:{name:"register"},class:"btn btn-primary"},{default:m(()=>[u(" Register ")]),_:1})])):_("",!0)]))],64)}const ut=x(N,[["render",at]]);export{ut as default};
